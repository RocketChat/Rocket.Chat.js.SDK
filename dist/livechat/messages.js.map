{"version":3,"file":"messages.js","sourceRoot":"","sources":["../../src/livechat/messages.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAA,+CAAgC;AAChC,oCAAoC;AACpC,qCAAmF;AACnF,yDAA0C;AAE1C,aAAO,EAAE,CAAA;AAET,SAAe,eAAe;;QAC5B,OAAO,CAAC,GAAG,CAAC,wCAAwC,CAAC,CAAA;QACrD,IAAI,KAAK,GAAG,QAAQ,CAAC,KAAK,CAAA;QAC1B,IAAI,CAAC,KAAK,IAAI,KAAK,KAAK,EAAE,EAAE;YAC1B,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,GAAG,CAAC,QAAQ,CAAC,YAAY,CAAC,kBAAW,CAAC,CAAA;YAChE,KAAK,GAAG,OAAO,IAAI,OAAO,CAAC,KAAK,CAAA;SACjC;QAED,OAAO,KAAK,CAAA;IACd,CAAC;CAAA;AAED,SAAe,OAAO,CAAE,KAAa;;QACnC,OAAO,CAAC,GAAG,CAAC,+BAA+B,CAAC,CAAA;QAC5C,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,CAAC,CAAA;QACnD,OAAO,IAAI,CAAA;IACb,CAAC;CAAA;AAED,SAAe,QAAQ;;QACrB,MAAM,KAAK,GAAG,MAAM,eAAe,EAAE,CAAA;QAErC,MAAM,IAAI,GAAG,MAAM,OAAO,CAAC,KAAK,CAAC,CAAA;QACjC,MAAM,GAAG,GAAG,IAAI,IAAI,IAAI,CAAC,GAAG,CAAA;QAE5B,MAAM,UAAU,GAAG;YAClB,KAAK;YACL,GAAG;YACH,GAAG,EAAE,4BAA4B;SACjC,CAAA;QAED,MAAM,WAAW,GAAG;YACnB,KAAK;YACL,GAAG;YACH,GAAG,EAAE,4BAA4B;SACjC,CAAA;QAED,MAAM,MAAM,GAAG,MAAM,GAAG,CAAC,QAAQ,CAAC,WAAW,CAAC,UAAU,CAAC,CAAA;QACzD,MAAM,GAAG,GAAG,MAAM,IAAI,MAAM,CAAC,OAAO,IAAI,MAAM,CAAC,OAAO,CAAC,GAAG,CAAA;QAE1D,MAAM,cAAc,GAAG,EAAE,KAAK,EAAE,GAAG,EAAE,CAAA;QACrC,MAAM,QAAQ,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,4BAAqB,EAAE,EAAE,GAAG,EAAE,CAAC,CAAA;QAElE,OAAO,CAAC,GAAG,CAAC;;;;;EAKZ,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,IAAI,EAAE,IAAI,CAAC;;;EAGlC,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,QAAQ,CAAC,WAAW,CAAC,GAAG,EAAE,WAAW,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC;;;EAG5E,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,QAAQ,CAAC,YAAY,CAAC,GAAG,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC;;;EAG3E,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,QAAQ,CAAC,aAAa,CAAC,GAAG,EAAE,EAAE,KAAK,EAAE,GAAG,EAAE,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC;;;EAGjF,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,QAAQ,CAAC,kBAAkB,CAAC,yBAAkB,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC;;;EAGrF,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,QAAQ,CAAC,qBAAqB,CAAC,cAAc,EAAE,QAAQ,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC;;GAE7F,CAAC,CAAA;IACJ,CAAC;CAAA;AAED,QAAQ,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAA","sourcesContent":["import * as api from './lib/api'\nimport { silence } from '../lib/log'\nimport { mockVisitor, mockOfflineMessage, mockVisitorNavigation } from './lib/mock'\nimport * as settings from './lib/settings'\n\nsilence()\n\nasync function getVisitorToken () {\n  console.log('\\nPreparing visitor token for tests...')\n  let token = settings.token\n  if (!token || token === '') {\n    const { visitor } = await api.livechat.grantVisitor(mockVisitor)\n    token = visitor && visitor.token\n  }\n\n  return token\n}\n\nasync function getRoom (token: string) {\n  console.log('\\nPreparing room for tests...')\n  const { room } = await api.livechat.room({ token })\n  return room\n}\n\nasync function messages () {\n  const token = await getVisitorToken()\n\n  const room = await getRoom(token)\n  const rid = room && room._id\n\n  const newMessage = {\n\t  token,\n\t  rid,\n\t  msg: 'sending livechat message..'\n  }\n\n  const editMessage = {\n\t  token,\n\t  rid,\n\t  msg: 'editing livechat message..'\n  }\n\n  const result = await api.livechat.sendMessage(newMessage)\n  const _id = result && result.message && result.message._id\n\n  const roomCredential = { token, rid }\n  const pageInfo = Object.assign({}, mockVisitorNavigation, { rid })\n\n  console.log(`\n\nDemo of API livechat query helpers\n\nSend Livechat Message \\`api.livechat.sendMessage()\\`:\n${JSON.stringify(result, null, '\\t')}\n\nEdit Livechat Message \\`api.livechat.editMessage()\\`:\n${JSON.stringify(await api.livechat.editMessage(_id, editMessage), null, '\\t')}\n\nLoad Livechat Messages \\`api.livechat.loadMessages()\\`:\n${JSON.stringify(await api.livechat.loadMessages(rid, { token }), null, '\\t')}\n\nDelete Livechat Message \\`api.livechat.deleteMessage()\\`:\n${JSON.stringify(await api.livechat.deleteMessage(_id, { token, rid }), null, '\\t')}\n\nSend Livechat Offline Message \\`api.livechat.sendOfflineMessage()\\`:\n${JSON.stringify(await api.livechat.sendOfflineMessage(mockOfflineMessage), null, '\\t')}\n\nSend Livechat Visitor Navigation \\`api.livechat.sendVisitorNavigation()\\`:\n${JSON.stringify(await api.livechat.sendVisitorNavigation(roomCredential, pageInfo), null, '\\t')}\n\n  `)\n}\n\nmessages().catch((e) => console.error(e))\n"]}